COMET INFO: old comet version (3.1.2) detected. current: 3.1.6 please update your comet lib with command: `pip install --no-cache-dir --upgrade comet_ml`
COMET INFO: Experiment is live on comet.ml https://www.comet.ml/ttpro1995/crowd-counting-debug/296c15f703d944abbc899509217a2948

cuda
Namespace(batch_size=5, datasetname='shanghaitech_rnd', decay=0.0001, epochs=301, input='/data/ShanghaiTech/part_B', load_model='', lr=0.0001, model='M4', momentum=0.9, note='M4 shanghaitech_rnd', task_id='local_M4_t2_shb', test=False)
cannot detect dataset_name
current dataset_name is  shanghaitech_rnd
in ListDataset dataset_name is |shanghaitech_rnd|
in ListDataset dataset_name is |shanghaitech_rnd|
len train_loader  320
M4(
  (front_cnn_1): Conv2d(3, 20, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (front_cnn_2): Conv2d(20, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (front_cnn_3): Conv2d(16, 14, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (front_cnn_4): Conv2d(14, 10, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (max_pooling): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (c0): Conv2d(40, 60, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2), dilation=(2, 2))
  (c1): Conv2d(60, 60, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2), dilation=(2, 2))
  (c2): Conv2d(60, 60, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2), dilation=(2, 2))
  (c3): Conv2d(60, 30, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2), dilation=(2, 2))
  (c4): Conv2d(30, 15, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2), dilation=(2, 2))
  (c5): Conv2d(15, 10, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2), dilation=(2, 2))
  (output): Conv2d(10, 1, kernel_size=(1, 1), stride=(1, 1))
)
Namespace(batch_size=5, datasetname='shanghaitech_rnd', decay=0.0001, epochs=301, input='/data/ShanghaiTech/part_B', load_model='', lr=0.0001, model='M4', momentum=0.9, note='M4 shanghaitech_rnd', task_id='local_M4_t2_shb', test=False)
do not load, keep training
2020-04-23 18:29 Epoch[1] Loss: 11.75
2020-04-23 18:31 Epoch[1] Loss: 1.50
2020-04-23 18:33 Epoch[1] Loss: 186.33
2020-04-23 18:34 Training set Results - Epoch: 1  Avg mae: 10.82 Avg mse: 28.86 Avg loss: 43.24
batch_timer  1.1728258961000022
train_timer  375.97995851999985
2020-04-23 18:35 Validation set Results - Epoch: 1  Avg mae: 58.16 Avg mse: 77.97 Avg loss: 40.49
evaluate_timer  474.39532556299946
Engine run is terminating due to exception: 'valid_mae'.
Traceback (most recent call last):
  File "experiment_meow_main.py", line 201, in <module>
    trainer.run(train_loader, max_epochs=args.epochs)
  File "/home/tt/miniconda3/envs/pytorch_gpu/lib/python3.7/site-packages/ignite/engine/engine.py", line 850, in run
    return self._internal_run()
  File "/home/tt/miniconda3/envs/pytorch_gpu/lib/python3.7/site-packages/ignite/engine/engine.py", line 952, in _internal_run
    self._handle_exception(e)
  File "/home/tt/miniconda3/envs/pytorch_gpu/lib/python3.7/site-packages/ignite/engine/engine.py", line 716, in _handle_exception
    raise e
  File "/home/tt/miniconda3/envs/pytorch_gpu/lib/python3.7/site-packages/ignite/engine/engine.py", line 942, in _internal_run
    self._fire_event(Events.EPOCH_COMPLETED)
  File "/home/tt/miniconda3/envs/pytorch_gpu/lib/python3.7/site-packages/ignite/engine/engine.py", line 607, in _fire_event
    func(self, *(event_args + args), **kwargs)
  File "/home/tt/miniconda3/envs/pytorch_gpu/lib/python3.7/site-packages/ignite/handlers/checkpoint.py", line 171, in __call__
    priority = self._score_function(engine)
  File "experiment_meow_main.py", line 183, in checkpoint_valid_mae_score_function
    score = engine.state.metrics['valid_mae']
KeyError: 'valid_mae'
COMET INFO: ----------------------------
COMET INFO: Comet.ml Experiment Summary:
COMET INFO:   Data:
COMET INFO:     url: https://www.comet.ml/ttpro1995/crowd-counting-debug/296c15f703d944abbc899509217a2948
COMET INFO:   Metrics [count] (min, max):
COMET INFO:     batch_timer                  : (1.1728258961000022, 1.1728258961000022)
COMET INFO:     epoch                        : (1.0, 1.0)
COMET INFO:     evaluate_timer               : (474.39532556299946, 474.39532556299946)
COMET INFO:     loss [32]                    : (1.0665087699890137, 585.623291015625)
COMET INFO:     lr                           : (0.0001, 0.0001)
COMET INFO:     sys.cpu.percent.01 [8]       : (6.0, 59.9)
COMET INFO:     sys.cpu.percent.02 [8]       : (4.7, 51.6)
COMET INFO:     sys.cpu.percent.03 [8]       : (2.5, 39.7)
COMET INFO:     sys.cpu.percent.04 [8]       : (5.0, 74.2)
COMET INFO:     sys.cpu.percent.05 [8]       : (2.3, 27.1)
COMET INFO:     sys.cpu.percent.06 [8]       : (4.1, 27.6)
COMET INFO:     sys.cpu.percent.avg [8]      : (19.55, 27.066666666666666)
COMET INFO:     sys.gpu.0.free_memory [8]    : (1940848640.0, 3300524032.0)
COMET INFO:     sys.gpu.0.gpu_utilization [8]: (4.0, 100.0)
COMET INFO:     sys.gpu.0.total_memory       : (4234936320.0, 4234936320.0)
COMET INFO:     sys.gpu.0.used_memory [8]    : (934412288.0, 2294087680.0)
COMET INFO:     sys.load.avg [8]             : (1.07, 1.63)
COMET INFO:     sys.ram.total [8]            : (33607774208.0, 33607774208.0)
COMET INFO:     sys.ram.used [8]             : (6373793792.0, 7998341120.0)
COMET INFO:     train_loss                   : (43.24176017493009, 43.24176017493009)
COMET INFO:     train_mae                    : (10.818375327587127, 10.818375327587127)
COMET INFO:     train_mse                    : (28.85955970076625, 28.85955970076625)
COMET INFO:     train_timer                  : (375.97995851999985, 375.97995851999985)
COMET INFO:     valid_loss                   : (40.486990099277676, 40.486990099277676)
COMET INFO:     valid_mae                    : (58.15887939477269, 58.15887939477269)
COMET INFO:     valid_mse                    : (77.97296361611996, 77.97296361611996)
COMET INFO:   Other [count]:
COMET INFO:     Name      : local_M4_t2_shb
COMET INFO:     model     : M4
COMET INFO:     model_note: We replace 5x5 7x7 9x9 with 3x3, no batchnorm yet, change tail to dilated max 60 with dilated 2
COMET INFO:     n_param   : 115002
COMET INFO:   Uploads:
COMET INFO:     git-patch  : 1
COMET INFO:     text-sample: 1
COMET INFO: ----------------------------
COMET INFO: Uploading stats to Comet before program termination (may take several seconds)
